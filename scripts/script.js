//--------------------Отримання доступу до елементів з index------------------------//

// Отримуємо поле вводу для додавання пари "Name=Value"
const inputPair = document.getElementById('inputPair');
// Отримуємо список, у який будуть додаватися пари
const list = document.getElementById('list');

//----------------------------Додавання пари у список-----------------------------//

function addPair() {
    // Видаляємо зайві пробіли з введеного значення
    const value = inputPair.value.trim();

    //------------------------Перевірка наявності знака "="-----------------------//
    // Якщо в рядку немає символу "=", показуємо повідомлення про помилку
    if (!value.includes('=')) {
        alert("Неправильний формат! Використовуйте формат Name=Value.");
        return; // Зупиняємо виконання функції
    }

    //---------------------------Розділення на "ім'я" та "значення"-----------------//
    // Розділяємо рядок на дві частини: "ім'я" та "значення" за знаком "="
    const parts = value.split('=');
    // Видаляємо зайві пробіли з "ім'я"
    const name = parts[0].trim();
    // Видаляємо зайві пробіли з "значення"
    const val = parts[1]?.trim(); // Перевіряємо, чи є друга частина (уникаємо помилки)

    //---------------------------Перевірка на валідність (лише букви та цифри)----------//
    // Функція для перевірки валідності (тільки латинські букви та цифри)
    function isValid(str) {
        // Перебираємо кожен символ рядка
        for (let i = 0; i < str.length; i++) {
            const char = str[i];
            // Якщо символ не є літерою або цифрою, повертаємо false
            if (!((char >= 'a' && char <= 'z') ||
                (char >= 'A' && char <= 'Z') ||
                (char >= '0' && char <= '9'))) {
                return false; // Неприпустимий символ
            }
        }
        return true; // Усі символи припустимі
    }

    // Функція для перевірки "ім'я" та "значення"
    if (!isValid(name) || !isValid(val)) {
        // Якщо хоч один із рядків не відповідає вимогам, показуємо помилку
        alert("Неправильний формат! Використовуйте лише букви та цифри.");
        return; // Зупиняємо виконання функції
    }

    //----------------------------------Додавання пари у список-----------------------------------//
    // Формуємо рядок у форматі "Name=Value"
    const pair = `${name}=${val}`;
    // Створюємо новий елемент <option> для списку
    const option = document.createElement('option');
    // Встановлюємо значення елемента
    option.value = pair;
    // Встановлюємо текст, який відображається в елементі
    option.textContent = pair;
    // Додаємо новий елемент у список
    list.appendChild(option);

    // Очищуємо поле вводу після додавання
    inputPair.value = "";
}
//----------------------------------Обробка події натискання Enter---------------------------------//
inputPair.addEventListener('keydown', (event) => {
    if (event.key === 'Enter') {
        event.preventDefault(); // Запобігаємо стандартній дії (перехід на наступний елемент)
        addPair(); // Викликаємо функцію додавання пари
    }
});

//------------------------------------- Сортування за ім'ям------------------------------------//

function sortByName() {
    // Отримуємо всі елементи списку як масив
    const options = Array.from(list.options);
    // Сортуємо елементи за частиною "ім'я" (до символу "=")
    options.sort((a, b) => a.value.split('=')[0].localeCompare(b.value.split('=')[0]));
    // Очищаємо список перед додаванням відсортованих елементів
    list.innerHTML = '';
    // Додаємо відсортовані елементи назад у список
    options.forEach(option => list.appendChild(option));
}

//-------------------------------------- Сортування за значенням----------------------------------------//

function sortByValue() {
    // Отримуємо всі елементи списку як масив
    const options = Array.from(list.options);
    // Сортуємо елементи за частиною "значення" (після символу "=")
    options.sort((a, b) => {
        const valueA = a.value.split('=')[1].trim(); // Витягуємо "значення" першого елемента
        const valueB = b.value.split('=')[1].trim(); // Витягуємо "значення" другого елемента
        return valueA.localeCompare(valueB); // Порівнюємо значення
    });
    // Очищаємо список перед додаванням відсортованих елементів
    list.innerHTML = '';
    // Додаємо відсортовані елементи назад у список
    options.forEach(option => list.appendChild(option));
}

//---------------------------------------Видалення вибраних елементів---------------------------------//

function deleteSelected() {
    // Отримуємо всі вибрані елементи зі списку як масив
    const selectedOptions = Array.from(list.selectedOptions);
    // Видаляємо кожен обраний елемент зі списку
    selectedOptions.forEach(option => option.remove());
}
